<?xml version="1.0" encoding="UTF-8"?>
<root>
    <!-- [PMS0860060] 取得業務員多筆-->
    <dao name="QRY_SALES_MN">
        <statement><![CDATA[
        SELECT SALES_COD, SALES_NAM, HOTEL_SALES, BQ_SALES, MEMBER_SALES FROM SALES_MN
        WHERE ATHENA_ID = :athena_id and trim(CLASS_COD) = trim(:class_cod) ORDER BY SALES_COD
        ]]></statement>
        <parameter type="int" kind="3">athena_id</parameter>
        <parameter type="string" kind="3">class_cod</parameter>
    </dao>

    <!-- [PMS0860060]
         未於業務員資料中指定者可刪除
         訊息:業務員資料維護已使用,不可刪除 -->
    <dao name="CHK_SALES_CLASS_ISEXIST">
        <statement><![CDATA[
        select count(*) as sales_mn_count from sales_mn
        where athena_id = :athena_id and trim(class_cod) = trim(:class_cod) and rownum = 1
        ]]></statement>
        <parameter type="int" kind="3">athena_id</parameter>
        <parameter type="string" kind="3">class_cod</parameter>
    </dao>


    <!--[PMS0620010] 取得業務員多筆-->
    <dao name="QRY_SALES_MN_ORDER_BY_SALE_COD_AND_DECODE_STATUS_COD">
        <statement><![CDATA[
        SELECT  SALES_COD, SALES_NAM, STATUS_COD, CLASS_COD, HOTEL_SALES, BQ_SALES, MEMBER_SALES, USER_NOS  FROM  SALES_MN
        WHERE  ATHENA_ID = :athena_id
        ]]></statement>
        <parameter type="number" kind="3">athena_id</parameter>
        <parameter type="string" kind="2" condition="trim(SALES_COD) = trim(:SALES_COD) ">sales_cod</parameter>
        <parameter type="string" kind="2" condition="trim(SALES_NAM) = trim(:SALES_NAM) ">sales_nam</parameter>
        <parameter type="string" kind="2" condition="trim(STATUS_COD) = trim(:STATUS_COD) ">status_cod</parameter>
        <parameter type="string" kind="2" condition="trim(CLASS_COD) = trim(:CLASS_COD) ">class_cod</parameter>
        <parameter type="string" kind="2" condition="trim(HOTEL_SALES) = trim(:HOTEL_SALES) ">hotel_sales</parameter>
        <parameter type="string" kind="2" condition="trim(BQ_SALES) = trim(:BQ_SALES) ">bq_sales</parameter>
        <parameter type="string" kind="2" condition="trim(MEMBER_SALES) = trim(:MEMBER_SALES) ">member_sales</parameter>
        <orderby>ORDER  BY  DECODE( STATUS_COD, 'N', 1, 2 ), SALES_COD</orderby>
    </dao>

    <!--[PMS0620020] 取得業務員sales_mn-->
    <dao name="QRY_SALES_MN_ALL_FIELDS">
        <statement><![CDATA[
        SELECT  trim(SALES_COD) as sales_cod, trim(SALES_NAM) as sales_nam, STATUS_COD, CLASS_COD, HOTEL_SALES, BQ_SALES, MEMBER_SALES, USER_NOS, INS_DAT, INS_USR, UPD_DAT, UPD_USR, TEL_NOS
        FROM  SALES_MN WHERE  ATHENA_ID = :athena_id AND trim(SALES_COD)= trim(:sales_cod)
        ]]></statement>
        <parameter type="number" kind="3">athena_id</parameter>
        <parameter type="string" kind="3">sales_cod</parameter>
    </dao>


    <!--[PMS0620020] 檢查使用者代號(訂席用)欄位設定資料是否於其他業務員資料已設定
    訊息「使用者代號(訂席用) [%% user_nos%%] 已於其他業務員資料指定」-->
    <dao name="QRY_USER_NOS_IN_SALES_MN">
        <statement><![CDATA[
        select count(*) as user_nos_count from sales_mn
        where athena_id = :athena_id and trim(sales_cod)<> trim(:sales_cod) and trim(user_nos) = trim(:user_nos)
        ]]></statement>
        <parameter type="number" kind="3">athena_id</parameter>
        <parameter type="string" kind="3">sales_cod</parameter>
        <parameter type="string" kind="3">user_nos</parameter>
    </dao>
</root>